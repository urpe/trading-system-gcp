version: '3.8'

services:
  # --- SERVICIOS DE DATOS (DATA LAYER) ---
  market-data:
    container_name: bot_ojos
    build: .
    command: python3 src/services/market_data/main.py
    env_file: .env
    restart: always

  historical-data:
    container_name: bot_historia
    build: .
    command: python3 src/services/historical/main.py
    env_file: .env
    ports:
      - "5002:5000"
    restart: always

  # --- AGENTES DE DECISIÃ“N (LOGIC LAYER) ---
  strategy:
    container_name: bot_cerebro
    build: .
    command: python3 src/agents/strategy/main.py
    env_file: .env
    ports:
      - "5000:5000"
    restart: always
    depends_on:
      - market-data

  orders:
    container_name: bot_manos
    build: .
    command: python3 src/agents/orders/main.py
    env_file: .env
    ports:
      - "5001:5001"
    restart: always
    depends_on:
      - strategy

  portfolio:
    container_name: bot_contador
    build: .
    command: python3 src/agents/portfolio/main.py
    env_file: .env
    restart: always

  # --- HERRAMIENTAS ESPECIALIZADAS ---
  pairs-trading:
    container_name: bot_pares
    build: .
    command: python3 src/services/pairs/main.py
    env_file: .env
    restart: always

  simulator:
    container_name: bot_simulador
    build: .
    command: python3 src/services/simulator/main.py
    env_file: .env
    restart: always

  alerts:
    container_name: bot_alertas
    build: .
    command: python3 src/services/alerts/main.py
    env_file: .env
    restart: always

  # --- INTERFAZ DE USUARIO (UI LAYER) ---
  dashboard:
    container_name: bot_cara
    build: .
    command: python3 src/dashboard/main.py
    env_file: .env
    ports:
      - "8050:8050"
    restart: always
    depends_on:
      - historical-data
      - strategy
      - simulator
      - pairs-trading