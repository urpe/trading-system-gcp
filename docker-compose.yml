version: '3.8'

services:
  # --- CORE UI ---
  dashboard:
    build: .
    command: python src/services/dashboard/app.py
    ports: ["8050:8050"]
    environment:
      - PROJECT_ID=mi-proyecto-trading-12345
      - PYTHONUNBUFFERED=1
    volumes:
      - ./src:/app/src

  # --- CORE TRADING ---
  portfolio:
    build: .
    command: python src/services/portfolio/main.py
    environment:
      - PROJECT_ID=mi-proyecto-trading-12345
      - PYTHONUNBUFFERED=1
    volumes:
      - ./src:/app/src

  orders:
    build: .
    command: python src/services/orders/main.py
    environment:
      - PROJECT_ID=mi-proyecto-trading-12345
      - PYTHONUNBUFFERED=1
    volumes:
      - ./src:/app/src
    depends_on:
      - portfolio

  brain:
    build: .
    command: python src/services/brain/main.py
    environment:
      - PROJECT_ID=mi-proyecto-trading-12345
      - PYTHONUNBUFFERED=1
    volumes:
      - ./src:/app/src

  # --- ADVANCED MODULES (RESTORED) ---
  pairs:
    build: .
    command: python src/services/pairs/main.py
    environment:
      - PROJECT_ID=mi-proyecto-trading-12345
      - PYTHONUNBUFFERED=1
    volumes:
      - ./src:/app/src

  simulator:
    build: .
    command: python src/services/simulator/main.py
    environment:
      - PROJECT_ID=mi-proyecto-trading-12345
      - PYTHONUNBUFFERED=1
    volumes:
      - ./src:/app/src

  # --- DATA SERVICES ---
  market-data:
    build: .
    command: python src/services/market_data/main.py
    environment:
      - PROJECT_ID=mi-proyecto-trading-12345
    volumes:
      - ./src:/app/src
  
  historical:
    build: .
    command: python src/services/historical/main.py
    volumes:
      - ./src:/app/src

  alerts:
    build: .
    command: python src/services/alerts/main.py
    volumes:
      - ./src:/app/src

